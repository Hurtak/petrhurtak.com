(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[557],{9750:function(e){e.exports="/_next/static/videos/packaging-a8a9afb79e609bea3f9d6be2a4726bfe.mp4"},6030:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/articles/debian-packages",function(){return n(8557)}])},6482:function(e,i,n){"use strict";n.d(i,{Br:function(){return s.Br},EK:function(){return s.EK},Ee:function(){return s.Ee},H1:function(){return s.H1},H2:function(){return s.H2},HO:function(){return s.HO},Li:function(){return s.Li},P:function(){return s.P},S0:function(){return s.S0},Tc:function(){return s.Tc},Tr:function(){return s.Tr},Tx:function(){return s.Tx},_P:function(){return s._P},aV:function(){return s.aV},cK:function(){return s.cK},iA:function(){return s.iA},nk:function(){return s.nk},pu:function(){return s.pu},rU:function(){return s.rU},z1:function(){return s.z1}});var s=n(9465)},7776:function(e,i,n){"use strict";n.d(i,{x:function(){return m}});var s=n(5893),r=n(645),a=n.n(r),c=n(9008),t=n.n(c),l=n(8422),d=n(7001),h=n(191),o=n(4047);let x=()=>(0,s.jsx)(s.Fragment,{children:"\xb7"});var j=n(9829);let p=e=>e.format("YYYY-MMM-DD"),u=e=>{let{articleBlog:i,articleComponent:n}=e,r=d.h.utc(i.datePublication),c=i.dateLastUpdate?d.h.utc(i.dateLastUpdate):void 0;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.$,{title:i.title}),(0,s.jsx)(t(),{children:(0,s.jsx)("meta",{name:"description",content:i.description,className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]])})}),(0,s.jsxs)("article",{className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]]),children:[(0,s.jsx)("h1",{className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]]),children:i.title}),(0,s.jsx)("p",{className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]])+" time-wrapper",children:c?(0,s.jsxs)(s.Fragment,{children:["Published"," ",(0,s.jsx)("time",{title:"Publication date",dateTime:r.toISOString(),className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]]),children:p(r)}),(0,s.jsx)("br",{className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]])}),"Updated:"," ",(0,s.jsx)("time",{title:"Last update date",dateTime:c.toISOString(),className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]]),children:p(c)})]}):(0,s.jsx)("time",{title:"Publication date",dateTime:r.toISOString(),className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]]),children:p(r)})}),(0,s.jsx)("div",{className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]])+" article-content",children:(0,s.jsx)(n,{className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]])})})]}),(0,s.jsxs)("p",{className:a().dynamic([["9afce2f4c51a17ad",[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)]]])+" links",children:[(0,s.jsx)(j.r,{href:l._j.articleGitHubLink(i.articleDirectory),children:"Edit on GitHub"})," ",(0,s.jsx)(x,{})," ",(0,s.jsx)(j.r,{href:l._j.articleXSearch(i.slug),children:"Discuss on X"})," "]}),(0,s.jsx)(a(),{id:"9afce2f4c51a17ad",dynamic:[(0,h.LH)(.5),(0,h.LH)(5),(0,h.LH)(2),(0,h.LH)(3)],children:"h1.__jsx-style-dynamic-selector{margin:0}.time-wrapper.__jsx-style-dynamic-selector{margin:0}time.__jsx-style-dynamic-selector{display:inline-block;padding-top:".concat((0,h.LH)(.5),"}.article-content.__jsx-style-dynamic-selector{padding-top:").concat((0,h.LH)(5),"}.article-content.__jsx-style-dynamic-selector>*{margin:").concat((0,h.LH)(2)," 0}.article-content.__jsx-style-dynamic-selector>*:first-child{margin-top:0}.article-content.__jsx-style-dynamic-selector>*:last-child{margin-bottom:0}.links.__jsx-style-dynamic-selector{margin:0;margin-top:").concat((0,h.LH)(3),"}")})]})},m=e=>i=>{let{articleBlog:n}=i;return(0,s.jsx)(u,{articleBlog:n,articleComponent:e})}},8557:function(e,i,n){"use strict";n.r(i),n.d(i,{__N_SSG:function(){return c},default:function(){return t}});var s=n(5893),r=n(6482),a=n(7776),c=!0,t=(0,a.x)(()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.P,{children:["At ",(0,s.jsx)(r.rU,{href:"https://www.seznam.cz/",children:"Seznam.cz"})," we use Debian packages for packaging and distribution of a decent amount of our applications. While we are in the process of transitioning to solutions using Docker, Debian packages still play a significant role."]}),(0,s.jsx)(r.P,{children:"In this article, I will tell you the basics about how to make a simple Debian package with a static website. I wrote this article from the frontend developer point of view, so not all parts of Debian packaging are covered."}),(0,s.jsx)(r.H1,{children:"Basics"}),(0,s.jsxs)(r.aV,{children:[(0,s.jsxs)(r.Li,{children:["Create a directory named ",(0,s.jsx)(r.EK,{children:"debian"})," in the root of your project."]}),(0,s.jsxs)(r.Li,{children:["We will use ",(0,s.jsx)(r.EK,{children:"debhelper"})," which is a collection of small tools that are used to automate various aspects of building a Debian package."]}),(0,s.jsxs)(r.Li,{children:["Add ",(0,s.jsx)(r.EK,{children:"DEBEMAIL"})," and ",(0,s.jsx)(r.EK,{children:"DEBFULLNAME"})," environment variables to your",(0,s.jsx)(r.EK,{children:".bashrc"})," to have your name and email automatically filled when you will manipulate the changelog with the ",(0,s.jsx)(r.EK,{children:"dch"}),"."]})]}),(0,s.jsx)(r.EK,{language:"bash",children:'\n      export DEBFULLNAME="Forename Surname"\n      export DEBEMAIL="name@email.com"\n    '}),(0,s.jsxs)(r.aV,{children:[(0,s.jsxs)(r.Li,{children:["You will need ",(0,s.jsx)(r.EK,{children:"debhelper"})," and ",(0,s.jsx)(r.EK,{children:"dch"}),". These tools are in ",(0,s.jsx)(r.EK,{children:"build-essential"})," and"," ",(0,s.jsx)(r.EK,{children:"devscripts"})," packages."]}),(0,s.jsx)(r.Li,{children:(0,s.jsx)(r.EK,{language:"bash",children:"apt-get install build-essential devscripts"})})]}),(0,s.jsx)(r.H1,{children:"Folder structure"}),(0,s.jsxs)(r.P,{children:["Inside the ",(0,s.jsx)(r.EK,{children:"debian"})," folder you will need to create these five files:"]}),(0,s.jsxs)(r.iA,{heading:(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:"Filename"}),(0,s.jsx)(r.Tc,{children:"Description"})]}),children:[(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:"changelog"}),(0,s.jsx)(r.Tc,{children:"Changes and release dates of each version of your package."})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:"compat"}),(0,s.jsx)(r.Tc,{children:"Defines the debhelper compatibility level."})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:"control"}),(0,s.jsx)(r.Tc,{children:"Metadata about the package, like its name, maintainers or dependencies."})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:"rules"}),(0,s.jsx)(r.Tc,{children:"Specifies how to build the package."})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{noWrap:!0,children:"package-name.install"}),(0,s.jsx)(r.Tc,{children:"What files to include in the package."})]})]}),(0,s.jsx)(r.H1,{children:"Changelog file"}),(0,s.jsxs)(r.P,{children:["Create ",(0,s.jsx)(r.EK,{children:"debian/changelog"})," file, either by running ",(0,s.jsx)(r.EK,{children:"dch --create"})," or manually."]}),(0,s.jsx)(r.EK,{children:"\n      package-name (0.0.1) UNRELEASED; urgency=medium\n\n        * Initial release.\n\n      -- Forename Surname <name@email.com>  Mon, 15 May 2017 20:00:00 +0200\n    "}),(0,s.jsx)(r.H2,{children:"Working with the changelog"}),(0,s.jsxs)(r.iA,{heading:(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:"Command"}),(0,s.jsx)(r.Tc,{children:"Description"})]}),children:[(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{noWrap:!0,children:(0,s.jsx)(r.EK,{children:"dch --create"})}),(0,s.jsxs)(r.Tc,{children:["Creates new changelog file with ",(0,s.jsx)(r.Tx,{children:"Initial release"})," entry."]})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.EK,{children:"dch"})}),(0,s.jsxs)(r.Tc,{children:["Adds new version if the latest one is not ",(0,s.jsx)(r.Tx,{children:"UNRELEASED"}),". Otherwise, it adds a new item to the current version and updates the date."]})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.EK,{children:"dch -r"})}),(0,s.jsxs)(r.Tc,{children:["Changes from ",(0,s.jsx)(r.Tx,{children:"UNRELEASED"})," to released state and updates the date."]})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:"Just use your editor"}),(0,s.jsx)(r.Tc,{children:"Works fine most of the time."})]})]}),(0,s.jsxs)(r.P,{children:["At Seznam.cz when we release a package we do not use the official distributions, instead we do something like"," ",(0,s.jsx)(r.EK,{children:"dch -r --force-distribution --distribution Seznam"}),"."]}),(0,s.jsx)(r.H1,{children:"Compat file"}),(0,s.jsxs)(r.P,{children:["The compat file defines the debhelper compatibility level."," ",(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/manuals/maint-guide/dother.en.html#compat",children:"Currently, you should set it to the debhelper v9"}),"."]}),(0,s.jsx)(r.EK,{language:"bash",children:"\n      echo 9 > debian/compat\n    "}),(0,s.jsx)(r.H1,{children:"Control file"}),(0,s.jsxs)(r.aV,{children:[(0,s.jsx)(r.Li,{children:"In this file, we specify all the metadata about our packages, like their names, dependencies, and maintainers."}),(0,s.jsxs)(r.Li,{children:["There are two types of packages:",(0,s.jsxs)(r.aV,{children:[(0,s.jsxs)(r.Li,{children:[(0,s.jsx)(r.cK,{children:"Source releases"}),": contain a human readable version of the application, meaning they have to be compiled before they can be used."]}),(0,s.jsxs)(r.Li,{children:[(0,s.jsx)(r.cK,{children:"Binary releases"}),": include computer readable version of the app, meaning they are already compiled."]})]})]}),(0,s.jsx)(r.Li,{children:"For our purposes, we will only build the binary package, but fields for the source release also need to be specified."})]}),(0,s.jsx)(r.H2,{children:"Minimal control file"}),(0,s.jsx)(r.EK,{children:"\n      Source: package-name\n      Maintainer: Forename Surname <name@email.com>\n      Section: fulltext/Seznam\n      Priority: extra\n      Build-Depends: debhelper (>= 9.0.0)\n      Standards-Version: 3.9.8\n\n      Package: package-name\n      Architecture: all\n      Section: fulltext/Seznam\n      Priority: extra\n      Depends: ${misc:Depends}\n      Description: Package description\n    "}),(0,s.jsx)(r.H2,{children:"Source package fields"}),(0,s.jsxs)(r.iA,{heading:(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:"Field"}),(0,s.jsx)(r.Tc,{children:"Type"}),(0,s.jsx)(r.Tc,{children:"Description"})]}),children:[(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-source",children:"Source"})}),(0,s.jsx)(r.Tc,{children:"mandatory"}),(0,s.jsxs)(r.Tc,{children:["The source package name. Must consist only of lower case letters (a-z), digits (0-9), plus (+) and minus (-) signs, and periods (.).",(0,s.jsx)("br",{}),(0,s.jsx)(r.EK,{children:"package-name"})]})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-maintainer",children:"Maintainer"})}),(0,s.jsx)(r.Tc,{children:"mandatory"}),(0,s.jsxs)(r.Tc,{children:["The package maintainerâ€™s name and email address.",(0,s.jsx)("br",{}),(0,s.jsx)(r.EK,{children:"Forename Surname <name@email.com>"}),"."]})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-section",children:"Section"})}),(0,s.jsx)(r.Tc,{children:"recommended"}),(0,s.jsxs)(r.Tc,{children:["An ",(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-archive.html#s-subsections",children:"application area"})," ","into which the package has been classified.",(0,s.jsx)("br",{}),"At Seznam.cz we use something like ",(0,s.jsx)(r.EK,{children:"fulltext/Seznam"}),"."]})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-priority",children:"Priority"})}),(0,s.jsx)(r.Tc,{children:"recommended"}),(0,s.jsxs)(r.Tc,{children:["How important it is that the user have the package installed. The"," ",(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-archive.html#s-priorities",children:"priorities"})," are (in descending order): ",(0,s.jsx)(r.EK,{children:"required"}),", ",(0,s.jsx)(r.EK,{children:"important"}),", ",(0,s.jsx)(r.EK,{children:"standard"}),", ",(0,s.jsx)(r.EK,{children:"optional"}),", ",(0,s.jsx)(r.EK,{children:"extra"}),"."]})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{noWrap:!0,children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-relationships.html#s-sourcebinarydeps",children:"Build-Depends"})}),(0,s.jsx)(r.Tc,{children:"optional"}),(0,s.jsx)(r.Tc,{children:"What dependencies need to be installed before we can start building the package."})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{noWrap:!0,children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-standards-version",children:"Standards-Version"})}),(0,s.jsx)(r.Tc,{children:"recommended"}),(0,s.jsxs)(r.Tc,{children:["The most recent version of the"," ",(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/",children:"Debian Policy Manual"})," with which the package complies. You can find the latest version at the bottom of every Debian policy page."]})]})]}),(0,s.jsx)(r.H2,{children:"Binary package fields"}),(0,s.jsxs)(r.iA,{heading:(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:"Field"}),(0,s.jsx)(r.Tc,{children:"Type"}),(0,s.jsx)(r.Tc,{children:"Description"})]}),children:[(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-package",children:"Package"})}),(0,s.jsx)(r.Tc,{children:"mandatory"}),(0,s.jsx)(r.Tc,{children:"Name of the binary package. Binary package names must follow the same syntax and restrictions as source package names."})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-architecture",children:"Architecture"})}),(0,s.jsx)(r.Tc,{children:"mandatory"}),(0,s.jsxs)(r.Tc,{children:["Usually one of the following:",(0,s.jsx)("br",{}),(0,s.jsx)(r.EK,{children:"all"})," - Architecture independent, usually consisting of text, images, or scripts in an interpreted language.",(0,s.jsx)("br",{}),(0,s.jsx)(r.EK,{children:"any"})," - Architecture dependent, usually in a compiled language."]})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-controlfields.html",children:"Section"})}),(0,s.jsx)(r.Tc,{children:"recommended"}),(0,s.jsx)(r.Tc,{children:"Same as Section of source package."})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-priority",children:"Priority"})}),(0,s.jsx)(r.Tc,{children:"recommended"}),(0,s.jsx)(r.Tc,{children:"Same as Priority of source package."})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-relationships.html#s-binarydeps",children:"Depends"})}),(0,s.jsx)(r.Tc,{children:"optional"}),(0,s.jsxs)(r.Tc,{children:["Dependencies of the package. Some debhelper commands may cause the generated package to depend on some additional packages. All such commands produce a list of required packages for each binary package. This list will then substitute the ",(0,s.jsx)(r.EK,{children:"${misc:Depends}"})," string."]})]}),(0,s.jsxs)(r.Tr,{children:[(0,s.jsx)(r.Tc,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-description",children:"Description"})}),(0,s.jsx)(r.Tc,{children:"mandatory"}),(0,s.jsx)(r.Tc,{children:"Description."})]})]}),(0,s.jsx)(r.H1,{children:"Rules file"}),(0,s.jsxs)(r.aV,{children:[(0,s.jsxs)(r.Li,{children:["Create ",(0,s.jsx)(r.EK,{children:"debian/rules"}),". This file is ",(0,s.jsx)(r.Tx,{children:"Makefile"})," so make sure to:",(0,s.jsxs)(r.aV,{children:[(0,s.jsxs)(r.Li,{children:["Mark it as executable ",(0,s.jsx)(r.EK,{children:"chmod u+x debian/rules"}),"."]}),(0,s.jsx)(r.Li,{children:"Use only tabs for indentation."})]})]}),(0,s.jsxs)(r.Li,{children:["This file contains rules about how to build your package. We will be using the ",(0,s.jsx)(r.EK,{children:"dh"})," command from the"," ",(0,s.jsx)(r.EK,{children:"debhelper"})," package to help us with the build. Here is minimal rules file that only calls the"," ",(0,s.jsx)(r.EK,{children:"dh"})," without any other configuration."]})]}),(0,s.jsx)(r.EK,{language:"makefile",children:"\n      #!/usr/bin/make -f\n\n      %:\n        dh $@\n    "}),(0,s.jsx)(r.aV,{children:(0,s.jsxs)(r.Li,{children:["The ",(0,s.jsx)(r.EK,{children:"dh"})," command has many build stages, and you will see them mentioned in the console once you start building your package. If you need to override or extend parts of the ",(0,s.jsx)(r.EK,{children:"dh"})," build steps, here is how you do it:"]})}),(0,s.jsx)(r.EK,{language:"makefile",children:"\n      #!/usr/bin/make -f\n\n      %:\n        dh $@\n\n      override_dh_auto_build:\n        dh_auto_build # We can omit this call and only use our scripts\n        ./my-script\n    "}),(0,s.jsx)(r.H1,{children:"Debian install script"}),(0,s.jsxs)(r.aV,{children:[(0,s.jsxs)(r.Li,{children:["Create file named ",(0,s.jsx)(r.EK,{children:"debian/package-name.install"}),"."]}),(0,s.jsx)(r.Li,{children:"In this file, we specify what files or folders will be copied into the package. Then once the package is installed, these files will be copied from the package onto the filesystem."}),(0,s.jsxs)(r.Li,{children:["Directories are relative to the parent of ",(0,s.jsx)(r.Tx,{children:"debian"})," directory, for example, if you have"," ",(0,s.jsx)(r.EK,{children:"project/debian/package-name.install"}),", paths will be relative to the ",(0,s.jsx)(r.EK,{children:"project"})," dir."]})]}),(0,s.jsx)(r.EK,{children:"\n      dist/* /www/package-name/\n    "}),(0,s.jsx)(r.H1,{children:"Build the package"}),(0,s.jsxs)(r.aV,{children:[(0,s.jsxs)(r.Li,{children:["In the root of your project directory run ",(0,s.jsx)(r.EK,{children:"dpkg-buildpackage -b -uc"}),".",(0,s.jsxs)(r.aV,{children:[(0,s.jsxs)(r.Li,{children:[(0,s.jsx)(r.EK,{children:"-b"})," only make a binary package and do not create a package with source files."]}),(0,s.jsxs)(r.Li,{children:[(0,s.jsx)(r.EK,{children:"-uc"})," skip the signing stage of the ",(0,s.jsx)(r.EK,{children:".changes"})," file with your PGP key."]})]})]}),(0,s.jsxs)(r.Li,{children:["If everything went ok, you should see file named ",(0,s.jsx)(r.EK,{children:"package-name_1.0.0_all.deb"})," one level up from the root directory of your project."]})]}),(0,s.jsx)(r.H2,{children:"Build artefacts"}),(0,s.jsxs)(r.P,{children:["After the build, you will see some build artifacts inside the ",(0,s.jsx)(r.EK,{children:"debian"})," directory. They are useful for your build debugging, but if everything goes ok, you can safely remove them with something like:"]}),(0,s.jsx)(r.EK,{language:"bash",children:"\n      git clean -df debian\n    "}),(0,s.jsx)(r.H1,{children:"Inspecting the package"}),(0,s.jsxs)(r.aV,{children:[(0,s.jsxs)(r.Li,{children:["To get basic metadata about package (mostly stuff from ",(0,s.jsx)(r.EK,{children:"debian/control"}),")",(0,s.jsx)(r.aV,{children:(0,s.jsx)(r.Li,{children:(0,s.jsx)(r.EK,{children:"dpkg --info <file>.deb"})})})]}),(0,s.jsxs)(r.Li,{children:["Midnight Commander program is pretty helpful if we want to take a look inside of the package",(0,s.jsxs)(r.aV,{children:[(0,s.jsx)(r.Li,{children:(0,s.jsx)(r.EK,{children:"sudo apt-get install mc"})}),(0,s.jsxs)(r.Li,{children:["Press ",(0,s.jsx)(r.EK,{children:"F3"})," or the ",(0,s.jsx)(r.EK,{children:"View"})," command while having the package selected to see basic info."]}),(0,s.jsx)(r.Li,{children:"Or press enter to open the package and inspect its content."})]})]}),(0,s.jsxs)(r.Li,{children:["Trying to install the package is also useful to see if there are not any conflicts or dependency problems",(0,s.jsx)(r.aV,{children:(0,s.jsx)(r.Li,{children:(0,s.jsx)(r.EK,{children:"sudo dpkg -i <file>.deb"})})})]})]}),(0,s.jsx)(r.nk,{width:698,height:308,src:n(9750)}),(0,s.jsx)(r.H1,{children:"Static files build dependencies"}),(0,s.jsxs)(r.P,{children:["So far we have only covered how to take already existing ",(0,s.jsx)(r.EK,{children:"dist"})," directory and package it up, but how do we express dependencies needed for building the ",(0,s.jsx)(r.EK,{children:"dist"})," directory? I think there are two reasonable approaches."]}),(0,s.jsx)(r.H2,{children:"Express everything in the debian/control and debian/rules"}),(0,s.jsx)(r.P,{children:"In case we would want to express the static files build dependencies and the build itself in the debian directory, here is how it could look like."}),(0,s.jsx)(r.P,{children:"Control file:"}),(0,s.jsxs)(r.aV,{children:[(0,s.jsxs)(r.Li,{children:["From ",(0,s.jsx)(r.EK,{children:"Build-Depends: debhelper (>= 9.0.0)"}),"."]}),(0,s.jsxs)(r.Li,{children:["To ",(0,s.jsx)(r.EK,{children:"Build-Depends: debhelper (>= 9.0.0), nodejs (>= 6.0.0)"})," (or whatever dependencis you need and can install with ",(0,s.jsx)(r.EK,{children:"apt"}),")."]})]}),(0,s.jsx)(r.P,{children:"Rules file:"}),(0,s.jsx)(r.aV,{children:(0,s.jsx)(r.Li,{children:"Add an override to the build step where we will do the installation of additional dependencies from other package managers and also the building itself."})}),(0,s.jsx)(r.EK,{language:"makefile",children:"\n      #!/usr/bin/make -f\n\n      %:\n        dh $@\n\n      override_dh_auto_build:\n        cd src && npm install && ./build-script\n      "}),(0,s.jsx)(r.H2,{children:"CI Build pipeline"}),(0,s.jsxs)(r.P,{children:["If we have some CI build pipeline, it makes more sense to have one CI task for the build of the static files, and another one for the creation of the Debian package. Then we just pass the build artifacts from the build task to the package task. This will allow use to use the right Docker image for given task (e.g. ",(0,s.jsx)(r.EK,{children:"node:7"})," for the static files, and ",(0,s.jsx)(r.EK,{children:"debian:8"})," for the packaging) and worry less about installing additional dependencies."]}),(0,s.jsx)(r.H2,{children:"Example of GitLab CI file"}),(0,s.jsx)(r.EK,{language:"yaml",children:'\n      stages:\n        - build\n        - package\n\n      build:\n        stage: build\n        image: node:7.8.0\n        script:\n          - cd app\n          - npm install\n          - ./scripts/build\n        artifacts:\n          expire_in: "1 week"\n          paths:\n            - ./app/build\n\n      package:\n        stage: package\n        image: debian:8.8\n        script:\n          - apt-get update\n          - apt-get install --yes build-essential devscripts\n          - dpkg-buildpackage -b -uc\n          - mv ../*.deb .\n        artifacts:\n          expire_in: "1 week"\n          paths:\n            - ./*.deb\n    '}),(0,s.jsx)(r.H1,{children:"Links"}),(0,s.jsxs)(r.aV,{children:[(0,s.jsx)(r.Li,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/debian-policy/",children:"Debian Policy Manual"})}),(0,s.jsx)(r.Li,{children:(0,s.jsx)(r.rU,{href:"https://www.debian.org/doc/manuals/maint-guide/",children:"Debian New Maintainers Guide"})})]})]}))}},function(e){e.O(0,[163,733,888,774,179],function(){return e(e.s=6030)}),_N_E=e.O()}]);