<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="icon" type="image/svg" href="/favicon.svg" class="jsx-1788f26f963801ea"/><link rel="alternate" type="application/rss+xml" title="RSS feed for petrhurtak.com" href="/rss/feed.xml" class="jsx-1788f26f963801ea"/><link rel="alternate" type="application/atom+xml" title="Atom feed for petrhurtak.com" href="/rss/atom.xml" class="jsx-1788f26f963801ea"/><link rel="alternate" type="application/feed+json" title="JSON Feed for petrhurtak.com" href="/rss/feed.json" class="jsx-1788f26f963801ea"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" class="jsx-1788f26f963801ea"/><title>Common software architecture mistakes – petrhurtak.com</title><meta name="description" content="I have been doing lots of code reviews lately and these are the mistakes that I see in pull requests the most often." class="jsx-3660295720"/><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/e344c169fdbe9c5f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e344c169fdbe9c5f.css" data-n-g=""/><link rel="preload" href="/_next/static/css/f2fec8308b1481ee.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f2fec8308b1481ee.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-59c5c889f52620d6.js" defer=""></script><script src="/_next/static/chunks/framework-64ad27b21261a9ce.js" defer=""></script><script src="/_next/static/chunks/main-6e375934f7db9407.js" defer=""></script><script src="/_next/static/chunks/pages/_app-73a777ca58ee6ff1.js" defer=""></script><script src="/_next/static/chunks/163-292c136d2e80f39f.js" defer=""></script><script src="/_next/static/chunks/733-8b179d7687f3748f.js" defer=""></script><script src="/_next/static/chunks/pages/articles/_common-sw-architecture-mistakes-7a7941057365dca2.js" defer=""></script><script src="/_next/static/OV2WtO7UMex4fkF0pVbp5/_buildManifest.js" defer=""></script><script src="/_next/static/OV2WtO7UMex4fkF0pVbp5/_ssgManifest.js" defer=""></script><style id="__jsx-1788f26f963801ea">body{margin:0}</style><style id="__jsx-3388121443">a.link{display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex;color:blue;text-decoration-thickness:0.5px;text-underline-offset:1px}a.link:visited{color:purple}</style><style id="__jsx-917cb3630f67ab81">q.jsx-917cb3630f67ab81{quotes:"“""”"}</style><style id="__jsx-2798449809">.refractor{background:#f3f3f3!important;border:1px solid #dadada;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px}.code-inline.jsx-2798449809{display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex;width:auto}.code-inline.jsx-2798449809 .refractor{padding:1px!important;font-size:14px!important}.code-block.jsx-2798449809 .refractor{padding:8px!important;font-size:12px!important}.no-highlight.jsx-2798449809 .token{color:black!important;background:none!important}</style><style id="__jsx-3660295720">h1.jsx-3660295720{margin:0}.time-wrapper.jsx-3660295720{margin:0}time.jsx-3660295720{display:inline-block;padding-top:4px}.article-content.jsx-3660295720{padding-top:40px}.article-content.jsx-3660295720>*{margin:16px 0}.article-content.jsx-3660295720>*:first-child{margin-top:0}.article-content.jsx-3660295720>*:last-child{margin-bottom:0}.links.jsx-3660295720{margin:0;margin-top:24px}</style><style id="__jsx-835579187">body{overflow-y:scroll}.layout.jsx-835579187{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:grid;grid-template-areas:"header""main""footer";grid-template-rows:auto 1fr auto;grid-template-columns:1fr;min-width:400px;max-width:600px;min-height:100vh;margin:0 auto;padding:24px 16px}header.jsx-835579187{grid-area:header;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:8px;padding-bottom:24px}main.jsx-835579187{grid-area:main;-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;overflow-x:auto}footer.jsx-835579187{grid-area:footer;padding-top:16px;text-align:center}</style></head><body><div id="__next"><div class="jsx-835579187 layout"><header class="jsx-835579187"><a class="link" href="/"><img width="20" height="20" src="/_next/static/media/logo.0f65ee71.svg" alt="petrhurtak.com site logo" class="jsx-835579187"/></a><a class="link" href="/">petrhurtak.com</a></header><main class="jsx-835579187"><article class="jsx-3660295720"><h1 class="jsx-3660295720">Common software architecture mistakes</h1><p class="jsx-3660295720 time-wrapper"><time title="Publication date" dateTime="2022-02-04T00:00:00.000Z" class="jsx-3660295720">2022-Feb-04</time></p><div class="jsx-3660295720 article-content"><p>Over the years I have reviewed many pull requests, mainly on projects of ~10 people where not all of team members. Here is collection of the most common mistakes I have seen or made by myself on front-end related projects.</p><h2>1. Large never ending pull requests</h2><p>This is probably the most common, it usually goes like this</p><ul><li>You get large product task, you work on it for weeks.</li><li>You start getting behind, product starts asking when it will be done, so you start cranking more code with less quality.</li><li>You <q class="jsx-917cb3630f67ab81">finish</q> the task and tell on standup that it is done and just needs review.</li><li>Architects or senior members start reviewing the PR, it takes a long time (because it is super large) and they request lots of changes (because it is super large).</li><li>You start addressing the changes and you will keep saying on standup that it is almost done<!-- -->…<!-- --> for another week or two.</li><li>Nobody is happy.</li></ul><h3>How to prevent this</h3><ul><li><strong>Split the product tasks</strong> into smaller deliverables. Talk with product if it would make sens to deliver the task not all at once but with smaller deliverables.<ul><li>Dont<ul><li>Profile screen task (one large task with lots of functionality)</li></ul></li><li>Do<ul><li>Profile screen with basic information</li><li>Profile screen logout button</li><li>Profile screen change password</li></ul></li></ul></li><li><strong>Split the code</strong> into several PRs. Either have the PRs as small product deliverables, if that is not possible,<strong>introduce feature-flag</strong>, which will allow you to merge to main without affecting the product (eg users seeing partially implemented profile page).<ul><li>Dont<ul><li>One profile screen PR with 5000 lines of changes</li></ul></li><li>Do<ul><li>PR 1: Profile screen shell with feature flag</li><li>PR 2: Layout refactoring needed for the profile screen</li><li>PR 3: Profile screen layout and basic data</li><li>PR 4: Implement logout logic</li><li>PR 5: Profile screen logout button</li><li>PR 6: Add PasswordInput component</li><li>PR 7: Profile screen password change</li><li>PR 8: Profile screen enabled by removing feature flag</li></ul></li></ul></li><li><strong>Talk with someone experienced</strong> on the team about the task (ideally before you start working on the task), they will most likely tell bunch of important information like:<ul><li>We dont have this button, ask designed if he really wants new button or of we can reuse the ones we already have.</li><li>The profile page has the same layout as this other page, make sure to reuse the layout.</li><li>These are new component that we do not have, you will need to implement them.</li><li>Theming is missing in the ticket, but the app supports it everywhere, so it needs to be implemented.</li><li>You will be extending these auth related modules, this are their shortcoming, so beware of them or refactor them while you are touching the code.</li></ul></li><li><strong>Get feedback early</strong>, by rule of thumb, if your <strong>PR is bigger than 500 lines</strong>, you have are getting into the danger territory, where you probably have a problem and you should apply some of the tricks above.</li></ul><p>All of these are rule of thump recommendations.<!-- --> <strong>Some of the problems might be partially taken care of by some meetings</strong>(like grooming, or some weekly product-developer syncs). The recommendation can be applied after you start working on the task, the main point is that<!-- --> <strong>whenever you start seeing problems, you should be start talking about them</strong> (thats what the stand-ups are for) and try to apply some of the rules above to fix them.</p><h2>Naming things</h2><p>Use better names instead of comments</p><h3>Not great</h3><div class="jsx-2798449809 code-block"><pre class="refractor language-ts"><code class="language-ts"><span class="token comment">// Use only on TV</span>
<span class="token keyword">const</span> <span class="token constant">SCREEN_WIDTH_DIP</span> <span class="token operator">=</span> <span class="token operator">...</span>
<span class="token comment">// Use only on mobile</span>
<span class="token keyword">const</span> <span class="token constant">SCREEN_WIDTH</span> <span class="token operator">=</span> <span class="token operator">...</span>

<span class="token keyword">const</span> <span class="token constant">HIDE_MODAL_TIMEOUT</span> <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment">// seconds</span></code></pre></div><h3>Better</h3><div class="jsx-2798449809 code-block"><pre class="refractor language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token constant">SCREEN_WIDTH_MOBILE</span> <span class="token operator">=</span> <span class="token operator">...</span>
<span class="token keyword">const</span> <span class="token constant">SCREEN_WIDTH_TV</span> <span class="token operator">=</span> <span class="token operator">...</span>

<span class="token keyword">const</span> <span class="token constant">HIDE_MODAL_TIMEOUT_SECONDS</span> <span class="token operator">=</span> <span class="token number">10</span></code></pre></div><h2>Make sure the new code is in correct place</h2><p>Always when adding new module/class/function/constant, think about if you placed it at the correct place. The most common mistake is to just place it where you are currently editing code, which is lots of the times correct, but lost of the time also incorrect.</p><p>Most code bases have some architecture that tries to separate things into logical units (folders, modules,<!-- --> <!-- -->…<!-- -->). These units are usually separated by:</p><ul><li>Concept<ul><li>Pages, ui components, business logic, views, <!-- -->…</li><li>Home page, login page, register page, <!-- -->…</li><li>Controllers, services, mailers, views, <!-- -->…</li></ul></li><li>Granularity/Specificity<ul><li>Specific formatting function used only in one component vs formatting function used in multiple components but only in one concept (on most admin pages, but never on product pages) vs general formatting function used everywhere.</li><li>Specific button only used on register page vs General button that is used on all pages.</li><li>Specific color transformation used only in header vs general add opacity function used across the app</li></ul></li></ul><h3>Example incorrect specificity</h3><div class="jsx-2798449809 code-block"><pre class="refractor language-ts"><code class="language-ts"><span class="token comment">// src/styles/colors.ts</span>
<span class="token operator">...</span>

<span class="token comment">// src/styles/app-theme.ts</span>
<span class="token keyword">const</span> <span class="token function">addOpacity</span><span class="token punctuation">(</span>color<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> opacity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function-variable function">string</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">...</span>
<span class="token keyword">const</span> <span class="token function">getModalBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function-variable function">string</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">...</span>
<span class="token keyword">const</span> <span class="token function">getMobileMenuBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function-variable function">string</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">...</span></code></pre></div><p>Here we had incorrect mixture of specificity. There is general concept of <em>colors</em> that contains colors/functions used everywhere in the app, but there also was more specific concept of<!-- --> <em>app-theme</em>, that is more specific since it related to app theming and is basically sub concept of colors.</p><div class="jsx-2798449809 code-block"><pre class="refractor language-ts"><code class="language-ts"><span class="token comment">// src/styles/theme.ts</span>
<span class="token function">getModalBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token function">getMobileMenuBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span>

<span class="token comment">// src/styles/colors.ts</span>
<span class="token keyword">const</span> <span class="token function">addOpacity</span><span class="token punctuation">(</span>color<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> opacity<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function-variable function">string</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">...</span>
<span class="token keyword">const</span> <span class="token function">getModalBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function-variable function">string</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">...</span>
<span class="token keyword">const</span> <span class="token function">getMobileMenuBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function-variable function">string</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">...</span></code></pre></div></div></article><p class="jsx-3660295720 links"><a class="link" rel="noopener noreferrer" target="_blank" href="https://github.com/hurtak/petrhurtak.com/tree/main/articles/_2022-02-04--common-sw-architecture-mistakes/index.tsx">Edit on GitHub</a> <!-- -->·<!-- --> <a class="link" rel="noopener noreferrer" target="_blank" href="https://x.com/search?q=https%3A%2F%2Fpetrhurtak.com%2Farticles%2Fcommon-sw-architecture-mistakes">Discuss on X</a> </p></main><footer class="jsx-835579187">2015<!-- -->–<!-- -->2026<br class="jsx-835579187"/>Written by <!-- -->Petr Hurtak</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"articleBlog":{"id":"common-sw-architecture-mistakes","type":"ARTICLE_BLOG_HIDDEN","title":"Common software architecture mistakes","description":"I have been doing lots of code reviews lately and these are the mistakes that I see in pull requests the most often.","datePublication":1643932800000,"articlePath":"/home/runner/work/petrhurtak.com/petrhurtak.com/articles/_2022-02-04--common-sw-architecture-mistakes/metadata.json","articleDirectory":"_2022-02-04--common-sw-architecture-mistakes","slug":"common-sw-architecture-mistakes"}},"__N_SSG":true},"page":"/articles/_common-sw-architecture-mistakes","query":{},"buildId":"OV2WtO7UMex4fkF0pVbp5","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>