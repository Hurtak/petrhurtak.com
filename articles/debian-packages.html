<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="icon" type="image/svg" href="/favicon.svg" class="jsx-1788f26f963801ea"/><link rel="alternate" type="application/rss+xml" title="RSS feed for petrhurtak.com" href="/rss/feed.xml" class="jsx-1788f26f963801ea"/><link rel="alternate" type="application/atom+xml" title="Atom feed for petrhurtak.com" href="/rss/atom.xml" class="jsx-1788f26f963801ea"/><link rel="alternate" type="application/feed+json" title="JSON Feed for petrhurtak.com" href="/rss/feed.json" class="jsx-1788f26f963801ea"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" class="jsx-1788f26f963801ea"/><title>Debian packages and front-end apps at Seznam.cz – petrhurtak.com</title><meta name="description" content="How to make a simple Debian package with a static website – from a frontend developer point of view." class="jsx-3660295720"/><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/e344c169fdbe9c5f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e344c169fdbe9c5f.css" data-n-g=""/><link rel="preload" href="/_next/static/css/f2fec8308b1481ee.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f2fec8308b1481ee.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-59c5c889f52620d6.js" defer=""></script><script src="/_next/static/chunks/framework-64ad27b21261a9ce.js" defer=""></script><script src="/_next/static/chunks/main-6e375934f7db9407.js" defer=""></script><script src="/_next/static/chunks/pages/_app-73a777ca58ee6ff1.js" defer=""></script><script src="/_next/static/chunks/163-292c136d2e80f39f.js" defer=""></script><script src="/_next/static/chunks/733-8b179d7687f3748f.js" defer=""></script><script src="/_next/static/chunks/pages/articles/debian-packages-a6e6c9cb418a4eac.js" defer=""></script><script src="/_next/static/OV2WtO7UMex4fkF0pVbp5/_buildManifest.js" defer=""></script><script src="/_next/static/OV2WtO7UMex4fkF0pVbp5/_ssgManifest.js" defer=""></script><style id="__jsx-1788f26f963801ea">body{margin:0}</style><style id="__jsx-3388121443">a.link{display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex;color:blue;text-decoration-thickness:0.5px;text-underline-offset:1px}a.link:visited{color:purple}</style><style id="__jsx-2798449809">.refractor{background:#f3f3f3!important;border:1px solid #dadada;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px}.code-inline.jsx-2798449809{display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex;width:auto}.code-inline.jsx-2798449809 .refractor{padding:1px!important;font-size:14px!important}.code-block.jsx-2798449809 .refractor{padding:8px!important;font-size:12px!important}.no-highlight.jsx-2798449809 .token{color:black!important;background:none!important}</style><style id="__jsx-2127381202">.no-wrap.jsx-2127381202{white-space:nowrap}.center.jsx-2127381202{text-align:center}th.jsx-2127381202,td.jsx-2127381202{padding:2px 4px}th.jsx-2127381202{background:#dadada}td.jsx-2127381202{background:#f3f3f3}</style><style id="__jsx-cb0a0b6880d4c251">div.jsx-cb0a0b6880d4c251{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}</style><style id="__jsx-816159112">video.jsx-816159112{width:100%;max-width:698px;aspect-ratio:698/308}</style><style id="__jsx-3660295720">h1.jsx-3660295720{margin:0}.time-wrapper.jsx-3660295720{margin:0}time.jsx-3660295720{display:inline-block;padding-top:4px}.article-content.jsx-3660295720{padding-top:40px}.article-content.jsx-3660295720>*{margin:16px 0}.article-content.jsx-3660295720>*:first-child{margin-top:0}.article-content.jsx-3660295720>*:last-child{margin-bottom:0}.links.jsx-3660295720{margin:0;margin-top:24px}</style><style id="__jsx-835579187">body{overflow-y:scroll}.layout.jsx-835579187{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:grid;grid-template-areas:"header""main""footer";grid-template-rows:auto 1fr auto;grid-template-columns:1fr;min-width:400px;max-width:600px;min-height:100vh;margin:0 auto;padding:24px 16px}header.jsx-835579187{grid-area:header;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:8px;padding-bottom:24px}main.jsx-835579187{grid-area:main;-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;overflow-x:auto}footer.jsx-835579187{grid-area:footer;padding-top:16px;text-align:center}</style></head><body><div id="__next"><div class="jsx-835579187 layout"><header class="jsx-835579187"><a class="link" href="/"><img width="20" height="20" src="/_next/static/media/logo.0f65ee71.svg" alt="petrhurtak.com site logo" class="jsx-835579187"/></a><a class="link" href="/">petrhurtak.com</a></header><main class="jsx-835579187"><article class="jsx-3660295720"><h1 class="jsx-3660295720">Debian packages and front-end apps at Seznam.cz</h1><p class="jsx-3660295720 time-wrapper"><time title="Publication date" dateTime="2017-05-21T00:00:00.000Z" class="jsx-3660295720">2017-May-21</time></p><div class="jsx-3660295720 article-content"><p>At <a class="link" rel="noopener noreferrer" target="_blank" href="https://www.seznam.cz/">Seznam.cz</a> we use Debian packages for packaging and distribution of a decent amount of our applications. While we are in the process of transitioning to solutions using Docker, Debian packages still play a significant role.</p><p>In this article, I will tell you the basics about how to make a simple Debian package with a static website. I wrote this article from the frontend developer point of view, so not all parts of Debian packaging are covered.</p><h2>Basics</h2><ul><li>Create a directory named <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debian</code></span> in the root of your project.</li><li>We will use <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debhelper</code></span> which is a collection of small tools that are used to automate various aspects of building a Debian package.</li><li>Add <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">DEBEMAIL</code></span> and <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">DEBFULLNAME</code></span> environment variables to your<span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">.bashrc</code></span> to have your name and email automatically filled when you will manipulate the changelog with the <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dch</code></span>.</li></ul><div class="jsx-2798449809 code-block"><pre class="refractor language-bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">DEBFULLNAME</span><span class="token operator">=</span><span class="token string">&quot;Forename Surname&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">DEBEMAIL</span><span class="token operator">=</span><span class="token string">&quot;name@email.com&quot;</span></code></pre></div><ul><li>You will need <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debhelper</code></span> and <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dch</code></span>. These tools are in <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">build-essential</code></span> and<!-- --> <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">devscripts</code></span> packages.</li><li><span class="jsx-2798449809 code-inline"><code class="refractor" style="display:inline"><span class="token function">apt-get</span> <span class="token function">install</span> build-essential devscripts</code></span></li></ul><h2>Folder structure</h2><p>Inside the <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debian</code></span> folder you will need to create these five files:</p><table><thead><tr><th class="jsx-2127381202 ">Filename</th><th class="jsx-2127381202 ">Description</th></tr></thead><tbody><tr><td class="jsx-2127381202 ">changelog</td><td class="jsx-2127381202 ">Changes and release dates of each version of your package.</td></tr><tr><td class="jsx-2127381202 ">compat</td><td class="jsx-2127381202 ">Defines the debhelper compatibility level.</td></tr><tr><td class="jsx-2127381202 ">control</td><td class="jsx-2127381202 ">Metadata about the package, like its name, maintainers or dependencies.</td></tr><tr><td class="jsx-2127381202 ">rules</td><td class="jsx-2127381202 ">Specifies how to build the package.</td></tr><tr><td class="jsx-2127381202 no-wrap">package-name.install</td><td class="jsx-2127381202 ">What files to include in the package.</td></tr></tbody></table><h2>Changelog file</h2><p>Create <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debian/changelog</code></span> file, either by running <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dch <span class="token parameter variable">--create</span></code></span> or manually.</p><div class="jsx-2798449809 code-block no-highlight"><pre class="refractor language-bash"><code class="language-bash">package-name <span class="token punctuation">(</span><span class="token number">0.0</span>.1<span class="token punctuation">)</span> UNRELEASED<span class="token punctuation">;</span> <span class="token assign-left variable">urgency</span><span class="token operator">=</span>medium

  * Initial release.

-- Forename Surname <span class="token operator">&lt;</span>name@email.com<span class="token operator">&gt;</span>  Mon, <span class="token number">15</span> May <span class="token number">2017</span> <span class="token number">20</span>:00:00 +0200</code></pre></div><h3>Working with the changelog</h3><table><thead><tr><th class="jsx-2127381202 ">Command</th><th class="jsx-2127381202 ">Description</th></tr></thead><tbody><tr><td class="jsx-2127381202 no-wrap"><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dch <span class="token parameter variable">--create</span></code></span></td><td class="jsx-2127381202 ">Creates new changelog file with <em>Initial release</em> entry.</td></tr><tr><td class="jsx-2127381202 "><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dch</code></span></td><td class="jsx-2127381202 ">Adds new version if the latest one is not <em>UNRELEASED</em>. Otherwise, it adds a new item to the current version and updates the date.</td></tr><tr><td class="jsx-2127381202 "><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dch <span class="token parameter variable">-r</span></code></span></td><td class="jsx-2127381202 ">Changes from <em>UNRELEASED</em> to released state and updates the date.</td></tr><tr><td class="jsx-2127381202 ">Just use your editor</td><td class="jsx-2127381202 ">Works fine most of the time.</td></tr></tbody></table><p>At Seznam.cz when we release a package we do not use the official distributions, instead we do something like<!-- --> <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dch <span class="token parameter variable">-r</span> --force-distribution <span class="token parameter variable">--distribution</span> Seznam</code></span>.</p><h2>Compat file</h2><p>The compat file defines the debhelper compatibility level.<!-- --> <a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/manuals/maint-guide/dother.en.html#compat">Currently, you should set it to the debhelper v9</a>.</p><div class="jsx-2798449809 code-block"><pre class="refractor language-bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token number">9</span> <span class="token operator">&gt;</span> debian/compat</code></pre></div><h2>Control file</h2><ul><li>In this file, we specify all the metadata about our packages, like their names, dependencies, and maintainers.</li><li>There are two types of packages:<ul><li><strong>Source releases</strong>: contain a human readable version of the application, meaning they have to be compiled before they can be used.</li><li><strong>Binary releases</strong>: include computer readable version of the app, meaning they are already compiled.</li></ul></li><li>For our purposes, we will only build the binary package, but fields for the source release also need to be specified.</li></ul><h3>Minimal control file</h3><div class="jsx-2798449809 code-block no-highlight"><pre class="refractor language-bash"><code class="language-bash">Source: package-name
Maintainer: Forename Surname <span class="token operator">&lt;</span>name@email.com<span class="token operator">&gt;</span>
Section: fulltext/Seznam
Priority: extra
Build-Depends: debhelper <span class="token punctuation">(</span><span class="token operator">&gt;=</span> <span class="token number">9.0</span>.0<span class="token punctuation">)</span>
Standards-Version: <span class="token number">3.9</span>.8

Package: package-name
Architecture: all
Section: fulltext/Seznam
Priority: extra
Depends: <span class="token variable">${misc<span class="token operator">:</span>Depends}</span>
Description: Package description</code></pre></div><h3>Source package fields</h3><table><thead><tr><th class="jsx-2127381202 ">Field</th><th class="jsx-2127381202 ">Type</th><th class="jsx-2127381202 ">Description</th></tr></thead><tbody><tr><td class="jsx-2127381202 "><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-source">Source</a></td><td class="jsx-2127381202 ">mandatory</td><td class="jsx-2127381202 ">The source package name. Must consist only of lower case letters (a-z), digits (0-9), plus (+) and minus (-) signs, and periods (.).<br/><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">package-name</code></span></td></tr><tr><td class="jsx-2127381202 "><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-maintainer">Maintainer</a></td><td class="jsx-2127381202 ">mandatory</td><td class="jsx-2127381202 ">The package maintainer’s name and email address.<br/><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">Forename Surname <span class="token operator">&lt;</span>name@email.com<span class="token operator">&gt;</span></code></span>.</td></tr><tr><td class="jsx-2127381202 "><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-section">Section</a></td><td class="jsx-2127381202 ">recommended</td><td class="jsx-2127381202 ">An <a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-archive.html#s-subsections">application area</a> <!-- -->into which the package has been classified.<br/>At Seznam.cz we use something like <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">fulltext/Seznam</code></span>.</td></tr><tr><td class="jsx-2127381202 "><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-priority">Priority</a></td><td class="jsx-2127381202 ">recommended</td><td class="jsx-2127381202 ">How important it is that the user have the package installed. The<!-- --> <a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-archive.html#s-priorities">priorities</a> are (in descending order): <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">required</code></span>, <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">important</code></span>, <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">standard</code></span>, <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">optional</code></span>, <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">extra</code></span>.</td></tr><tr><td class="jsx-2127381202 no-wrap"><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-relationships.html#s-sourcebinarydeps">Build-Depends</a></td><td class="jsx-2127381202 ">optional</td><td class="jsx-2127381202 ">What dependencies need to be installed before we can start building the package.</td></tr><tr><td class="jsx-2127381202 no-wrap"><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-standards-version">Standards-Version</a></td><td class="jsx-2127381202 ">recommended</td><td class="jsx-2127381202 ">The most recent version of the<!-- --> <a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/">Debian Policy Manual</a> with which the package complies. You can find the latest version at the bottom of every Debian policy page.</td></tr></tbody></table><h3>Binary package fields</h3><table><thead><tr><th class="jsx-2127381202 ">Field</th><th class="jsx-2127381202 ">Type</th><th class="jsx-2127381202 ">Description</th></tr></thead><tbody><tr><td class="jsx-2127381202 "><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-package">Package</a></td><td class="jsx-2127381202 ">mandatory</td><td class="jsx-2127381202 ">Name of the binary package. Binary package names must follow the same syntax and restrictions as source package names.</td></tr><tr><td class="jsx-2127381202 "><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-architecture">Architecture</a></td><td class="jsx-2127381202 ">mandatory</td><td class="jsx-2127381202 ">Usually one of the following:<br/><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">all</code></span> - Architecture independent, usually consisting of text, images, or scripts in an interpreted language.<br/><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">any</code></span> - Architecture dependent, usually in a compiled language.</td></tr><tr><td class="jsx-2127381202 "><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-controlfields.html">Section</a></td><td class="jsx-2127381202 ">recommended</td><td class="jsx-2127381202 ">Same as Section of source package.</td></tr><tr><td class="jsx-2127381202 "><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-priority">Priority</a></td><td class="jsx-2127381202 ">recommended</td><td class="jsx-2127381202 ">Same as Priority of source package.</td></tr><tr><td class="jsx-2127381202 "><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-relationships.html#s-binarydeps">Depends</a></td><td class="jsx-2127381202 ">optional</td><td class="jsx-2127381202 ">Dependencies of the package. Some debhelper commands may cause the generated package to depend on some additional packages. All such commands produce a list of required packages for each binary package. This list will then substitute the <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline"><span class="token variable">${misc<span class="token operator">:</span>Depends}</span></code></span> string.</td></tr><tr><td class="jsx-2127381202 "><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/ch-controlfields.html#s-f-description">Description</a></td><td class="jsx-2127381202 ">mandatory</td><td class="jsx-2127381202 ">Description.</td></tr></tbody></table><h2>Rules file</h2><ul><li>Create <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debian/rules</code></span>. This file is <em>Makefile</em> so make sure to:<ul><li>Mark it as executable <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline"><span class="token function">chmod</span> u+x debian/rules</code></span>.</li><li>Use only tabs for indentation.</li></ul></li><li>This file contains rules about how to build your package. We will be using the <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dh</code></span> command from the<!-- --> <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debhelper</code></span> package to help us with the build. Here is minimal rules file that only calls the<!-- --> <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dh</code></span> without any other configuration.</li></ul><div class="jsx-2798449809 code-block"><pre class="refractor language-makefile"><code class="language-makefile"><span class="token comment">#!/usr/bin/make -f</span>

<span class="token target symbol">%</span><span class="token punctuation">:</span>
  dh <span class="token variable">$@</span></code></pre></div><ul><li>The <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dh</code></span> command has many build stages, and you will see them mentioned in the console once you start building your package. If you need to override or extend parts of the <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dh</code></span> build steps, here is how you do it:</li></ul><div class="jsx-2798449809 code-block"><pre class="refractor language-makefile"><code class="language-makefile"><span class="token comment">#!/usr/bin/make -f</span>

<span class="token target symbol">%</span><span class="token punctuation">:</span>
  dh <span class="token variable">$@</span>

<span class="token target symbol">override_dh_auto_build</span><span class="token punctuation">:</span>
  dh_auto_build <span class="token comment"># We can omit this call and only use our scripts</span>
  ./my-script</code></pre></div><h2>Debian install script</h2><ul><li>Create file named <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debian/package-name.install</code></span>.</li><li>In this file, we specify what files or folders will be copied into the package. Then once the package is installed, these files will be copied from the package onto the filesystem.</li><li>Directories are relative to the parent of <em>debian</em> directory, for example, if you have<!-- --> <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">project/debian/package-name.install</code></span>, paths will be relative to the <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">project</code></span> dir.</li></ul><div class="jsx-2798449809 code-block no-highlight"><pre class="refractor language-bash"><code class="language-bash">dist/* /www/package-name/</code></pre></div><h2>Build the package</h2><ul><li>In the root of your project directory run <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dpkg-buildpackage <span class="token parameter variable">-b</span> <span class="token parameter variable">-uc</span></code></span>.<ul><li><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline"><span class="token parameter variable">-b</span></code></span> only make a binary package and do not create a package with source files.</li><li><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline"><span class="token parameter variable">-uc</span></code></span> skip the signing stage of the <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">.changes</code></span> file with your PGP key.</li></ul></li><li>If everything went ok, you should see file named <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">package-name_1.0.0_all.deb</code></span> one level up from the root directory of your project.</li></ul><h3>Build artefacts</h3><p>After the build, you will see some build artifacts inside the <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debian</code></span> directory. They are useful for your build debugging, but if everything goes ok, you can safely remove them with something like:</p><div class="jsx-2798449809 code-block"><pre class="refractor language-bash"><code class="language-bash"><span class="token function">git</span> clean <span class="token parameter variable">-df</span> debian</code></pre></div><h2>Inspecting the package</h2><ul><li>To get basic metadata about package (mostly stuff from <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debian/control</code></span>)<ul><li><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dpkg <span class="token parameter variable">--info</span> <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span>.deb</code></span></li></ul></li><li>Midnight Commander program is pretty helpful if we want to take a look inside of the package<ul><li><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">mc</span></code></span></li><li>Press <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">F3</code></span> or the <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">View</code></span> command while having the package selected to see basic info.</li><li>Or press enter to open the package and inspect its content.</li></ul></li><li>Trying to install the package is also useful to see if there are not any conflicts or dependency problems<ul><li><span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline"><span class="token function">sudo</span> dpkg <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span>.deb</code></span></li></ul></li></ul><div class="jsx-cb0a0b6880d4c251"><video controls="" autoplay="" loop="" class="jsx-816159112"><source src="/_next/static/videos/packaging-a8a9afb79e609bea3f9d6be2a4726bfe.mp4" type="video/mp4" class="jsx-816159112"/></video></div><h2>Static files build dependencies</h2><p>So far we have only covered how to take already existing <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dist</code></span> directory and package it up, but how do we express dependencies needed for building the <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">dist</code></span> directory? I think there are two reasonable approaches.</p><h3>Express everything in the debian/control and debian/rules</h3><p>In case we would want to express the static files build dependencies and the build itself in the debian directory, here is how it could look like.</p><p>Control file:</p><ul><li>From <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">Build-Depends: debhelper <span class="token punctuation">(</span><span class="token operator">&gt;=</span> <span class="token number">9.0</span>.0<span class="token punctuation">)</span></code></span>.</li><li>To <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">Build-Depends: debhelper <span class="token punctuation">(</span><span class="token operator">&gt;=</span> <span class="token number">9.0</span>.0<span class="token punctuation">)</span>, nodejs <span class="token punctuation">(</span><span class="token operator">&gt;=</span> <span class="token number">6.0</span>.0<span class="token punctuation">)</span></code></span> (or whatever dependencis you need and can install with <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline"><span class="token function">apt</span></code></span>).</li></ul><p>Rules file:</p><ul><li>Add an override to the build step where we will do the installation of additional dependencies from other package managers and also the building itself.</li></ul><div class="jsx-2798449809 code-block"><pre class="refractor language-makefile"><code class="language-makefile"><span class="token comment">#!/usr/bin/make -f</span>

<span class="token target symbol">%</span><span class="token punctuation">:</span>
  dh <span class="token variable">$@</span>

<span class="token target symbol">override_dh_auto_build</span><span class="token punctuation">:</span>
  cd src &amp;&amp; npm install &amp;&amp; ./build-script</code></pre></div><h3>CI Build pipeline</h3><p>If we have some CI build pipeline, it makes more sense to have one CI task for the build of the static files, and another one for the creation of the Debian package. Then we just pass the build artifacts from the build task to the package task. This will allow use to use the right Docker image for given task (e.g. <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">node:7</code></span> for the static files, and <span class="jsx-2798449809 code-inline no-highlight"><code class="refractor" style="display:inline">debian:8</code></span> for the packaging) and worry less about installing additional dependencies.</p><h3>Example of GitLab CI file</h3><div class="jsx-2798449809 code-block"><pre class="refractor language-yaml"><code class="language-yaml"><span class="token key atrule">stages</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> build
  <span class="token punctuation">-</span> package

<span class="token key atrule">build</span><span class="token punctuation">:</span>
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> build
  <span class="token key atrule">image</span><span class="token punctuation">:</span> node<span class="token punctuation">:</span>7.8.0
  <span class="token key atrule">script</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> cd app
    <span class="token punctuation">-</span> npm install
    <span class="token punctuation">-</span> ./scripts/build
  <span class="token key atrule">artifacts</span><span class="token punctuation">:</span>
    <span class="token key atrule">expire_in</span><span class="token punctuation">:</span> <span class="token string">&quot;1 week&quot;</span>
    <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./app/build

<span class="token key atrule">package</span><span class="token punctuation">:</span>
  <span class="token key atrule">stage</span><span class="token punctuation">:</span> package
  <span class="token key atrule">image</span><span class="token punctuation">:</span> debian<span class="token punctuation">:</span><span class="token number">8.8</span>
  <span class="token key atrule">script</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> apt<span class="token punctuation">-</span>get update
    <span class="token punctuation">-</span> apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span><span class="token punctuation">-</span>yes build<span class="token punctuation">-</span>essential devscripts
    <span class="token punctuation">-</span> dpkg<span class="token punctuation">-</span>buildpackage <span class="token punctuation">-</span>b <span class="token punctuation">-</span>uc
    <span class="token punctuation">-</span> mv ../<span class="token important">*.deb</span> .
  <span class="token key atrule">artifacts</span><span class="token punctuation">:</span>
    <span class="token key atrule">expire_in</span><span class="token punctuation">:</span> <span class="token string">&quot;1 week&quot;</span>
    <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./<span class="token important">*.deb</span></code></pre></div><h2>Links</h2><ul><li><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/debian-policy/">Debian Policy Manual</a></li><li><a class="link" rel="noopener noreferrer" target="_blank" href="https://www.debian.org/doc/manuals/maint-guide/">Debian New Maintainers Guide</a></li></ul></div></article><p class="jsx-3660295720 links"><a class="link" rel="noopener noreferrer" target="_blank" href="https://github.com/hurtak/petrhurtak.com/tree/main/articles/2017-05-21--debian-packages/index.tsx">Edit on GitHub</a> <!-- -->·<!-- --> <a class="link" rel="noopener noreferrer" target="_blank" href="https://x.com/search?q=https%3A%2F%2Fpetrhurtak.com%2Farticles%2Fdebian-packages">Discuss on X</a> </p></main><footer class="jsx-835579187">2015<!-- -->–<!-- -->2026<br class="jsx-835579187"/>Written by <!-- -->Petr Hurtak</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"articleBlog":{"id":"debian-packages","type":"ARTICLE_BLOG_VISIBLE","title":"Debian packages and front-end apps at Seznam.cz","description":"How to make a simple Debian package with a static website – from a frontend developer point of view.","datePublication":1495324800000,"articlePath":"/home/runner/work/petrhurtak.com/petrhurtak.com/articles/2017-05-21--debian-packages/metadata.json","articleDirectory":"2017-05-21--debian-packages","slug":"debian-packages"}},"__N_SSG":true},"page":"/articles/debian-packages","query":{},"buildId":"OV2WtO7UMex4fkF0pVbp5","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>